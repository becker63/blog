flowchart LR
    subgraph Inputs
        A[Upstream APIs<br/>CRDs • Go Types • JSON Schema]
    end

    subgraph Build["Hermetic Build (Buck2 + Nix)"]
        B1[Python Model<br/>Codegen]
        B2[KCL Schema<br/>Codegen]
        B3[Protocol / App<br/>Schema Codegen]
    end

    subgraph Outputs
        C1[Typed Python Models]
        C2[Typed KCL Schemas]
    end

    A --> B1 --> C1
    A --> B2 --> C2
    B3 --> C2